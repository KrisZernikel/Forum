"use strict";

var helpers = require("../../node_modules/@parcel/transformer-react-refresh-wrap/lib/helpers/helpers.js");

var prevRefreshReg = window.$RefreshReg$;
var prevRefreshSig = window.$RefreshSig$;
helpers.prelude(module);

try {
  var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

  var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

  Object.defineProperty(exports, "__esModule", {
    value: true
  });
  exports["default"] = void 0;

  var _regenerator = _interopRequireDefault(require("@babel/runtime/regenerator"));

  var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

  var _reactCookie = require("react-cookie");

  var _reactRouterDom = require("react-router-dom");

  var _react = _interopRequireWildcard(require("react"));

  var _axios = _interopRequireDefault(require("axios"));

  var _Login = _interopRequireDefault(require("./components/Login"));

  var _Forum = _interopRequireDefault(require("./components/Forum"));

  var _s = $RefreshSig$();

  var Routes = function Routes(_ref) {
    _s();

    var cookies = _ref.cookies;
    console.log(JSON.stringify(cookies.get("user")));

    var signOut = function signOut() {
      cookies.remove('user');
    };

    var post = /*#__PURE__*/function () {
      var _ref2 = (0, _asyncToGenerator2["default"])( /*#__PURE__*/_regenerator["default"].mark(function _callee(data) {
        return _regenerator["default"].wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.next = 2;
                return (0, _axios["default"])({
                  method: "post",
                  url: "/api/dynamo/save-post",
                  data: data
                });

              case 2:
              case "end":
                return _context.stop();
            }
          }
        }, _callee);
      }));

      return function post(_x) {
        return _ref2.apply(this, arguments);
      };
    }();

    (0, _react.useEffect)(function () {
      window.history.replaceState('', document.title, window.location.pathname);
    });
    return /*#__PURE__*/_react["default"].createElement(_reactRouterDom.Switch, null, /*#__PURE__*/_react["default"].createElement(_reactRouterDom.Route, {
      exact: true,
      path: "/"
    }, !cookies.get('user') ? /*#__PURE__*/_react["default"].createElement(_Login["default"], null) : /*#__PURE__*/_react["default"].createElement(_Forum["default"], {
      user: cookies.get("user"),
      signOut: signOut,
      src: cookies.get("user").photos[0].value,
      post: post
    })));
  };

  _s(Routes, "OD7bBpZva5O2jO+Puf00hKivP7c=");

  _c = Routes;

  var _default = _c2 = (0, _reactCookie.withCookies)(Routes);

  exports["default"] = _default;

  var _c, _c2;

  $RefreshReg$(_c, "Routes");
  $RefreshReg$(_c2, "%default%");
  helpers.postlude(module);
} finally {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}